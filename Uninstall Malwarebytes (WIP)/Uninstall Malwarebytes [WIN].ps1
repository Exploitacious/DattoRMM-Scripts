<#
TITLE: Uninstall Malwarebytes [WIN]
PURPOSE: Attempts to uninstall Malwarebytes 
CREATOR: Dan Meddock
CREATED: 25AUG2022
LAST UPDATED: 25AUG2022
#>

# Declarations
$tempFolder = "C:\Downloads"
$application = 'Malwarebytes.zip'

# Main
Try{
	# Check if Temp folder exsists
	If(!(test-path $tempFolder -PathType Leaf)){new-item $tempFolder -ItemType Directory -force}
	
	# Transfer installers to computer
	Write-Host "Transferring installer to device."
	Copy-Item $application -Destination $tempFolder -force
	Expand-Archive -LiteralPath "$($tempFolder)\Malwarebytes.zip" -DestinationPath $tempFolder -Force

	# Start Malwarebytes application uninstall
	Write-Host "Starting uninstall of Malwarebytes."
	Powershell.exe -ExecutionPolicy Bypass "$($tempFolder)\Malwarebytes\Deploy-Malwarebytes.ps1" -DeploymentType "Uninstall" -DeployMode "Silent"

	Exit 0
	
# Catch any errors thrown and exit with an error
}catch{
	Write-Error $_.Exception.Message 
	Exit 1
}